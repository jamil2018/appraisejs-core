# Testing

This document explains how to generate, run, and debug tests.

## Test Model

- Feature files: `src/tests/features/**/*.feature`
- Step definitions: `src/tests/steps/**/*.step.ts`
- Hooks and world: `src/tests/hooks/hooks.ts`, `src/tests/config/executor/world.ts`

Scenario tags are important:

- `@tc_...` is required for test case sync and identification.
- Other tags are used for filtering (for example `@smoke`).

Feature files may be generated by the UI and include an auto-generated header. If you edit these files manually, your changes may be overwritten the next time the UI regenerates them.

## Running Tests

The default test command runs Cucumber with the repo configuration:

```bash
npm test
```

Common options (run with `npx cucumber-js`):

```bash
npx cucumber-js -t "@smoke"
npx cucumber-js -t "@smoke or @regression" --parallel 4
```

The runner reads several environment variables (see [Configuration](configuration.md)):

- `ENVIRONMENT`, `BROWSER`, `HEADLESS`
- `REPORT_PATH` (optional JSON report output path)
- `REPORT_FORMAT` (overrides report format string)

## Playwright Setup

Install Playwright browsers and OS dependencies:

```bash
npm run install-playwright
```

The full local setup script (`npm run setup`) runs this automatically.

## Reports

- Default Cucumber JSON output: `src/tests/reports/cucumber.json`
- UI-driven runs use `src/tests/reports/cucumber-<runId>-<timestamp>.json`
- Logs: `src/tests/reports/logs/<runId>.log`
- Traces (failed scenarios): `src/tests/reports/traces/*.zip`

## Debugging

- Run with `HEADLESS=false` to see the browser UI.
- Set `--parallel 1` to simplify logs when debugging.
- Check report JSON and log files under `src/tests/reports/`.
- Failed scenarios store Playwright traces (zip files) for deeper inspection.
