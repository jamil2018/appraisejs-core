# Auto-Generated Feature Files

This directory contains automatically generated Cucumber/Gherkin feature files that correspond to Test Suites in the application.

## ⚠️ IMPORTANT: Database Synchronization

**These files are auto-generated and can become out of sync with the database!**

### When Desync Can Occur:

1. **Merging changes from other developers** - Their feature files may not match your database
2. **Database migrations or resets** - Feature files remain but database content changes
3. **Manual database modifications** - Direct database changes bypass feature file updates
4. **Switching branches** - Different branches may have different database states

### How to Fix Desync:

Run the regeneration script to rebuild all feature files from your current database:

```bash
npm run regenerate-features
```

This command will:

- Delete all existing feature files
- Query the current database state
- Regenerate all feature files based on current Test Suites
- Organize files by module hierarchy

## How Feature Generation Works

### Automatic Generation:

- **Create Test Suite** → Feature file created in module directory
- **Update Test Suite** → Old feature file deleted (if name/module changed), new one generated
- **Delete Test Suite** → Feature file automatically removed

### File Organization:

- **Directory Structure**: Based on module hierarchy using module path builder
  - Module "User" → `/features/user/`
  - Module "User/Authentication" → `/features/user/authentication/`
- **File Naming**: Test suite name becomes filename (e.g., `login-tests.feature`)
- **Feature Title**: Test suite description becomes the feature title

### Content Structure:

```gherkin
# AUTO-GENERATED FILE - DO NOT EDIT MANUALLY
# This file is automatically generated from Test Suite data.
# Any manual changes will be overwritten when the Test Suite is updated.
# To modify this feature, update the corresponding Test Suite in the application.

Feature: [Test Suite Description]

  Scenario: [Test Case Title] [Test Case Description]
    Given [first step]
    When [action step]
    And [additional step]
    Then [assertion step]
```

## Best Practices

### For Developers:

1. **Never edit feature files manually** - Changes will be lost
2. **Run regeneration after merging** - Ensure files match your database
3. **Check feature files after database changes** - Verify they're still accurate
4. **Use the application UI** - Make all changes through Test Suite management

### For Teams:

1. **Feature files are gitignored** - They're not committed to prevent conflicts
2. **Each developer regenerates locally** - Based on their database state
3. **Database migrations should trigger regeneration** - Add to migration scripts
4. **Document the regeneration process** - Ensure all team members know about it

## Integration with Cucumber

These feature files can be used directly with Cucumber.js for automated testing:

```bash
# Run cucumber tests (after ensuring feature files are synced)
npx cucumber-js src/tests/features/**/*.feature
```

## Troubleshooting

### If you see unexpected feature content:

1. Check if your database is up to date: `npx prisma migrate dev`
2. Regenerate feature files: `npm run regenerate-features`
3. Verify Test Suite data in the application UI

### If feature files are missing:

1. Ensure Test Suites exist in your database
2. Run regeneration script: `npm run regenerate-features`
3. Check for errors in the console output

### If you get permission errors:

1. The script will handle file permissions automatically
2. If issues persist, manually delete the features directory and regenerate

---

**Remember**: Feature files are a reflection of your database state. When in doubt, regenerate them!

